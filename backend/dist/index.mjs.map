{"version":3,"file":"index.mjs","sources":["../src/preload.ts","../src/db.ts","../src/auth.ts","../src/routes/demo.ts","../src/models/Image.ts","../src/controllers/GalleryController.ts","../src/middleware/adminAuth.ts","../src/routes/gallery.ts","../src/models/Donor.ts","../src/controllers/DonorController.ts","../src/routes/donors.ts","../src/controllers/AuthController.ts","../src/routes/auth.ts","../src/models/Member.ts","../src/controllers/MemberController.ts","../src/routes/members.ts","../src/models/Celebration.ts","../src/controllers/CelebrationController.ts","../src/models/Product.ts","../src/controllers/ProductController.ts","../src/routes/celebrations.ts","../src/models/Order.ts","../src/routes/orders.ts","../src/index.ts"],"sourcesContent":["import dotenv from \"dotenv\";\r\nimport path from \"path\";\r\nimport { fileURLToPath } from \"url\";\r\n\r\n// This script is preloaded to ensure .env variables are available before any other code runs.\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\r\ndotenv.config({ path: path.resolve(__dirname, '../../.env') });","import mongoose from \"mongoose\";\n\nlet isConnected = false;\n\nexport async function connectMongo(uri?: string) {\n  const mongoUri = uri || process.env.MONGODB_URI;\n  if (!mongoUri) {\n    console.warn(\n      \"MongoDB URI not set. Running with in-memory fallback. Set MONGODB_URI to enable persistence.\",\n    );\n    return { connected: false } as const;\n  }\n  if (isConnected) return { connected: true } as const;\n  try {\n    await mongoose.connect(mongoUri, {\n      dbName: process.env.MONGODB_DB || undefined,\n    });\n    isConnected = true;\n    console.log(\"✅ Connected to MongoDB\");\n    return { connected: true } as const;\n  } catch (err) {\n    console.error(\"❌ MongoDB connection error:\", err);\n    return { connected: false } as const;\n  }\n}\n","import { hash, compare } from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\n\nconst ADMIN_EMAIL = process.env.ADMIN_EMAIL || \"admin@example.com\";\n\nexport async function hashPassword(password: string): Promise<string> {\n  return hash(password, 10);\n}\n\nexport async function comparePassword(password: string, hash: string): Promise<boolean> {\n  return compare(password, hash);\n}\n\nexport function createToken(payload: object): string {\n  const secret = process.env.ADMIN_JWT_SECRET;\n  if (!secret) {\n    throw new Error(\"ADMIN_JWT_SECRET not configured\");\n  }\n  return jwt.sign(payload, secret, { expiresIn: \"1h\" });\n}\n\nexport function verifyToken(token: string) {\n  const secret = process.env.ADMIN_JWT_SECRET;\n  if (!secret) {\n    return null;\n  }\n  try {\n    return jwt.verify(token, secret);\n  } catch {\n    return null;\n  }\n}\n\n// Placeholder for admin user in a real application, this would come from a database\nlet adminUser = {\n  email: ADMIN_EMAIL,\n  passwordHash: \"\" // This will be set on server start\n};\n\nexport async function initAdminUser() {\n  const adminPassword = process.env.ADMIN_PASSWORD;\n  if (!adminPassword) {\n    console.warn(\"ADMIN_PASSWORD not set. Admin login will be disabled.\");\n    return;\n  }\n  adminUser.passwordHash = await hashPassword(adminPassword);\n  console.log(\"✅ Admin user initialized\");\n}\n\nexport function getAdminUser() {\n  return adminUser;\n}","import { RequestHandler } from \"express\";\nimport type { DemoResponse } from \"../types/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import mongoose, { Schema, Document, Model } from \"mongoose\";\n\nexport interface IImage extends Document {\n  title: string;\n  url: string;\n  publicId?: string; // for Cloudinary\n  featured?: boolean;\n  createdAt: Date;\n}\n\nconst ImageSchema: Schema<IImage> = new Schema(\n  {\n    title: { type: String, required: true },\n    url: { type: String, required: true },\n    publicId: { type: String },\n    featured: { type: Boolean, default: false },\n  },\n  { timestamps: { createdAt: true, updatedAt: false } },\n);\n\nexport const ImageModel: Model<IImage> =\n  mongoose.models.Image || mongoose.model<IImage>(\"Image\", ImageSchema);\n","import { Response, Request } from \"express\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { fileURLToPath } from \"url\";\nimport { v2 as cloudinary } from \"cloudinary\";\nimport { connectMongo } from \"../db\";\nimport { ImageModel } from \"../models/Image\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport class GalleryController {\n  private uploadMiddleware = multer({\n    storage: multer.memoryStorage(),\n    limits: { fileSize: 20 * 1024 * 1024 },\n  });\n\n  private ensureUploadsDir(): string {\n    const uploadsDir = path.resolve(\n      __dirname,\n      \"../../public/uploads\"\n    );\n    if (!fs.existsSync(uploadsDir))\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    return uploadsDir;\n  }\n\n  private configureCloudinary(): boolean {\n    const { CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET } =\n      process.env;\n    if (CLOUDINARY_CLOUD_NAME && CLOUDINARY_API_KEY && CLOUDINARY_API_SECRET) {\n      cloudinary.config({\n        cloud_name: CLOUDINARY_CLOUD_NAME,\n        api_key: CLOUDINARY_API_KEY,\n        api_secret: CLOUDINARY_API_SECRET,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  getUploadMiddleware() {\n    return this.uploadMiddleware.array(\"images\", 12);\n  }\n\n  async getAll(req: Request, res: Response): Promise<void> {\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.json({ images: [] });\n      return;\n    }\n    const images = await ImageModel.find().sort({ createdAt: -1 }).lean();\n    res.json({ images });\n  }\n\n  async getFeatured(req: Request, res: Response): Promise<void> {\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.json({ images: [] });\n      return;\n    }\n    const images = await ImageModel.find({ featured: true })\n      .sort({ createdAt: -1 })\n      .lean();\n    res.json({ images });\n  }\n\n  async toggleFeatured(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { featured } = (req.body || {}) as { featured?: boolean };\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n    const update: any = {};\n    if (typeof featured === \"boolean\") update.featured = featured;\n    const doc = await ImageModel.findByIdAndUpdate(id, update, {\n      new: true,\n    }).lean();\n    if (!doc) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n    res.json({ image: doc });\n  }\n\n  async upload(req: Request, res: Response): Promise<void> {\n    const { connected } = await connectMongo();\n\n    const files = req.files as Express.Multer.File[] | undefined;\n    if (!files || files.length === 0) {\n      res.status(400).json({ error: \"No files uploaded\" });\n      return;\n    }\n\n    const cloudOk = this.configureCloudinary();\n    const uploadedResults: { title: string; url: string; publicId?: string }[] =\n      [];\n\n    try {\n      for (const file of files) {\n        const title = (req.body.title as string) || file.originalname;\n        let url = \"\";\n        let publicId: string | undefined;\n\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          url = uploaded.secure_url;\n          publicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          url = `/uploads/${filename}`;\n        }\n\n        if (connected) {\n          const doc = await ImageModel.create({ title, url, publicId });\n          uploadedResults.push({\n            title: doc.title,\n            url: doc.url,\n            publicId: doc.publicId,\n          });\n        } else {\n          uploadedResults.push({ title, url, publicId });\n        }\n      }\n\n      res.status(201).json({ images: uploadedResults });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Upload failed\" });\n    }\n  }\n\n  async delete(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n    const img = await ImageModel.findById(id).lean();\n    if (!img) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n    try {\n      if ((img as any).publicId) {\n        try {\n          await cloudinary.uploader.destroy((img as any).publicId);\n        } catch (e) {\n          console.warn(\"Cloudinary delete failed\", e);\n        }\n      } else if (img.url && (img.url as string).startsWith(\"/uploads/\")) {\n        const uploadsRoot = path.resolve(__dirname, \"../../public\");\n        const rel = (img.url as string).replace(/^\\//, \"\");\n        const filePath = path.join(uploadsRoot, rel);\n        try {\n          if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n        } catch (e) {\n          console.warn(\"Local file delete failed\", e);\n        }\n      }\n\n      await ImageModel.findByIdAndDelete(id);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Delete failed\" });\n    }\n  }\n}\n","import { RequestHandler } from \"express\";\nimport { verifyToken } from \"../auth\";\n\nexport const requireAdminKey: RequestHandler = (req, res, next) => {\n  // Support legacy x-admin-key header\n  const adminKey = process.env.ADMIN_API_KEY;\n  const providedKey = req.headers[\"x-admin-key\"] as string | undefined;\n\n  if (adminKey && providedKey && adminKey === providedKey) {\n    return next();\n  }\n\n  // Check Authorization: Bearer <token>\n  const authHeader = req.headers[\"authorization\"];\n  if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n    return res.status(401).json({ error: \"Unauthorized\" });\n  }\n\n  const token = authHeader.replace(\"Bearer \", \"\");\n  const verified = verifyToken(token);\n\n  if (!verified) {\n    return res.status(401).json({ error: \"Unauthorized\" });\n  }\n\n  (req as any).admin = verified; // attach payload if needed\n  next();\n};\n","import { Router } from \"express\";\nimport { GalleryController } from \"../controllers/GalleryController\";\nimport { requireAdminKey } from \"../middleware/adminAuth\";\n\nconst router = Router();\nconst galleryController = new GalleryController();\n\nrouter.get(\"/\", (req, res) => galleryController.getAll(req, res));\n\nrouter.get(\"/featured\", (req, res) => galleryController.getFeatured(req, res));\n\nrouter.patch(\"/admin/:id\", requireAdminKey, (req, res) =>\n  galleryController.toggleFeatured(req, res)\n);\n\nrouter.post(\n  \"/admin\",\n  requireAdminKey,\n  galleryController.getUploadMiddleware(),\n  (req, res) => galleryController.upload(req, res)\n);\n\nrouter.delete(\"/admin/:id\", requireAdminKey, (req, res) =>\n  galleryController.delete(req, res)\n);\n\nexport default router;\n","import mongoose, { Schema, Document, Model } from \"mongoose\";\n\nexport interface IDonor extends Document {\n  name: string;\n  tier: \"Platinum\" | \"Gold\" | \"Silver\" | \"Bronze\";\n  logoUrl?: string;\n  logoPublicId?: string;\n  website?: string;\n  donatedAmount?: number;\n  donatedCommodity?: string;\n  position: number;\n  createdAt: Date;\n}\n\nconst DonorSchema: Schema<IDonor> = new Schema(\n  {\n    name: { type: String, required: true },\n    tier: {\n      type: String,\n      enum: [\"Platinum\", \"Gold\", \"Silver\", \"Bronze\"],\n      required: true,\n    },\n    logoUrl: { type: String },\n    logoPublicId: { type: String },\n    website: { type: String },\n    donatedAmount: { type: Number },\n    donatedCommodity: { type: String },\n    position: { type: Number, default: 0 },\n  },\n  { timestamps: { createdAt: true, updatedAt: false } },\n);\n\nexport const DonorModel: Model<IDonor> =\n  mongoose.models.Donor || mongoose.model<IDonor>(\"Donor\", DonorSchema);\n","import { Response, Request } from \"express\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { fileURLToPath } from \"url\";\nimport { v2 as cloudinary } from \"cloudinary\";\nimport { connectMongo } from \"../db\";\nimport { DonorModel } from \"../models/Donor\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport class DonorController {\n  private uploadMiddleware = multer({\n    storage: multer.memoryStorage(),\n    limits: { fileSize: 5 * 1024 * 1024 },\n  });\n\n  private ensureUploadsDir(): string {\n    const uploadsDir = path.resolve(__dirname, \"../../public/uploads\");\n    if (!fs.existsSync(uploadsDir))\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    return uploadsDir;\n  }\n\n  private configureCloudinary(): boolean {\n    const { CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET } =\n      process.env;\n    if (CLOUDINARY_CLOUD_NAME && CLOUDINARY_API_KEY && CLOUDINARY_API_SECRET) {\n      cloudinary.config({\n        cloud_name: CLOUDINARY_CLOUD_NAME,\n        api_key: CLOUDINARY_API_KEY,\n        api_secret: CLOUDINARY_API_SECRET,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  getUploadMiddleware() {\n    return this.uploadMiddleware.single(\"logo\");\n  }\n\n  async getAll(req: Request, res: Response): Promise<void> {\n    try {\n      const { connected } = await connectMongo();\n      if (!connected) {\n        console.error(\"Database not connected, returning empty donors array.\");\n        res.json({ donors: [] });\n        return;\n      }\n      const donors = await DonorModel.find().sort({ position: 1 }).lean();\n      res.json({ donors });\n    } catch (e) {\n      console.error(\"Error in getAll donors:\", e);\n      res.status(500).json({ error: \"Failed to get donors\" });\n    }\n  }\n\n  async create(req: Request, res: Response): Promise<void> {\n    const { name, tier, website, donatedAmount, donatedCommodity } = req.body as {\n      name: string;\n      tier: \"Platinum\" | \"Gold\" | \"Silver\" | \"Bronze\";\n      website?: string;\n      donatedAmount?: string | number;\n      donatedCommodity?: string;\n    };\n    if (!name || !tier) {\n      res.status(400).json({ error: \"name and tier required\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let logoUrl: string | undefined;\n    let logoPublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n    try {\n      if (file) {\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          logoUrl = uploaded.secure_url;\n          logoPublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          logoUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const doc = await DonorModel.create({\n        name,\n        tier,\n        website,\n        logoUrl,\n        logoPublicId,\n        donatedAmount: donatedAmount ? Number(donatedAmount) : undefined,\n        donatedCommodity: donatedCommodity || undefined,\n      });\n      console.log(\"Donor created successfully:\", doc);\n\n      res.status(201).json({ donor: doc });\n    } catch (e) {\n      console.error(\"Error creating donor:\", e);\n      res.status(500).json({ error: \"Failed to create donor\" });\n    }\n  }\n\n  async delete(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    const donor = await DonorModel.findById(id).lean();\n    if (!donor) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n\n    try {\n      if ((donor as any).logoPublicId) {\n        try {\n          await cloudinary.uploader.destroy((donor as any).logoPublicId);\n        } catch {}\n      } else if (donor.logoUrl && donor.logoUrl.startsWith(\"/uploads/\")) {\n        const uploadsRoot = path.resolve(__dirname, \"../../public\");\n        const rel = donor.logoUrl.replace(/^\\//, \"\");\n        const filePath = path.join(uploadsRoot, rel);\n        try {\n          if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n        } catch {}\n      }\n\n      await DonorModel.findByIdAndDelete(id);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to delete donor\" });\n    }\n  }\n\n  async reorder(req: Request, res: Response): Promise<void> {\n    console.log(\"Reorder donors request received\");\n    const { orderedIds } = (req.body || {}) as { orderedIds?: string[] };\n    if (!Array.isArray(orderedIds)) {\n      res.status(400).json({ error: \"orderedIds must be an array\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    try {\n      const promises = orderedIds.map(async (id, index) => {\n        console.log(`Updating donor ${id} to position ${index}`);\n        const result = await DonorModel.updateOne({ _id: id }, { $set: { position: index } });\n        console.log(`Donor ${id} update result:`, result);\n        return result;\n      });\n      await Promise.all(promises);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to reorder donors\" });\n    }\n  }\n}\n","import { Router } from \"express\";\nimport { DonorController } from \"../controllers/DonorController\";\nimport { requireAdminKey } from \"../middleware/adminAuth\";\n\nconst router = Router();\nconst donorController = new DonorController();\n\nrouter.get(\"/\", (req, res) => donorController.getAll(req, res));\n\nrouter.post(\n  \"/admin\",\n  requireAdminKey,\n  donorController.getUploadMiddleware(),\n  (req, res) => donorController.create(req, res)\n);\n\nrouter.delete(\"/admin/:id\", requireAdminKey, (req, res) =>\n  donorController.delete(req, res)\n);\n\nrouter.post(\"/admin/reorder\", requireAdminKey, (req, res) =>\n  donorController.reorder(req, res)\n);\n\nexport default router;\n","import { Response, Request } from \"express\";\nimport {\n  comparePassword,\n  createToken,\n  getAdminUser,\n  initAdminUser\n} from \"../auth\";\n\nexport class AuthController {\n  async login(req: Request, res: Response): Promise<void> {\n    const { email, password } = req.body;\n\n    if (!email || !password) {\n      res.status(400).json({ error: \"Email and password are required\" });\n      return;\n    }\n\n    const adminUser = getAdminUser();\n\n    if (!adminUser || !adminUser.passwordHash) {\n      res.status(500).json({ error: \"Server misconfigured: Admin user not initialized\" });\n      return;\n    }\n\n    if (email !== adminUser.email) {\n      res.status(401).json({ error: \"Invalid credentials\" });\n      return;\n    }\n\n    const isMatch = await comparePassword(password, adminUser.passwordHash);\n\n    if (!isMatch) {\n      res.status(401).json({ error: \"Invalid credentials\" });\n      return;\n    }\n\n    try {\n      const token = createToken({ id: adminUser.email, isAdmin: true });\n      res.json({ token });\n    } catch (err: any) {\n      console.error(\"Error creating token:\", err);\n      res.status(500).json({ error: \"Failed to create authentication token\" });\n    }\n  }\n\n  async logout(req: Request, res: Response): Promise<void> {\n    // For JWT, logout is client-side (delete token from storage).\n    // Server-side, we just acknowledge the request.\n    res.status(200).json({ message: \"Logged out successfully\" });\n  }\n}","import { Router } from \"express\";\nimport { AuthController } from \"../controllers/AuthController\";\nimport multer from \"multer\";\n\nconst router = Router();\nrouter.use(multer().none());\nconst authController = new AuthController();\n\nrouter.post(\"/login\", (req, res) => authController.login(req, res));\n\nexport default router;\n","import mongoose, { Schema, Document, Model } from \"mongoose\";\n\nexport interface IMember extends Document {\n  name: string;\n  role: string;\n  bio?: string;\n  photoUrl?: string;\n  photoPublicId?: string;\n  instaId?: string;\n  email?: string;\n  contact?: string;\n  position: number;\n  createdAt: Date;\n}\n\nconst MemberSchema: Schema<IMember> = new Schema(\n  {\n    name: { type: String, required: true },\n    role: { type: String },\n    bio: { type: String },\n    photoUrl: { type: String },\n    photoPublicId: { type: String },\n    instaId: { type: String },\n    email: { type: String },\n    contact: { type: String },\n    position: { type: Number, default: 0 },\n  },\n  { timestamps: { createdAt: true, updatedAt: false } },\n);\n\nexport const MemberModel: Model<IMember> =\n  mongoose.models.Member || mongoose.model<IMember>(\"Member\", MemberSchema);\n","import { Response, Request } from \"express\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { fileURLToPath } from \"url\";\nimport { v2 as cloudinary } from \"cloudinary\";\nimport { connectMongo } from \"../db\";\nimport { MemberModel } from \"../models/Member\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport class MemberController {\n  private uploadMiddleware = multer({\n    storage: multer.memoryStorage(),\n    limits: { fileSize: 5 * 1024 * 1024 },\n  });\n\n  private ensureUploadsDir(): string {\n    const uploadsDir = path.resolve(__dirname, \"../../public/uploads\");\n    if (!fs.existsSync(uploadsDir))\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    return uploadsDir;\n  }\n\n  private configureCloudinary(): boolean {\n    const { CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET } =\n      process.env;\n    if (CLOUDINARY_CLOUD_NAME && CLOUDINARY_API_KEY && CLOUDINARY_API_SECRET) {\n      cloudinary.config({\n        cloud_name: CLOUDINARY_CLOUD_NAME,\n        api_key: CLOUDINARY_API_KEY,\n        api_secret: CLOUDINARY_API_SECRET,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  getUploadMiddleware() {\n    return this.uploadMiddleware.single(\"photo\");\n  }\n\n  async getAll(req: Request, res: Response): Promise<void> {\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.json({ members: [] });\n      return;\n    }\n    const members = await MemberModel.find().sort({ position: 1 }).lean();\n    res.json({ members });\n  }\n\n  async create(req: Request, res: Response): Promise<void> {\n    const { name, role, bio, instaId, email, contact } = req.body as {\n      name?: string;\n      role?: string;\n      bio?: string;\n      instaId?: string;\n      email?: string;\n      contact?: string;\n    };\n    if (!name) {\n      res.status(400).json({ error: \"name required\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let photoUrl: string | undefined;\n    let photoPublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n    try {\n      if (file) {\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          photoUrl = uploaded.secure_url;\n          photoPublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          fs.writeFileSync(path.join(uploadsDir, filename), file.buffer);\n          photoUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const doc = await MemberModel.create({\n        name,\n        role: (role as any) || \"Core\",\n        bio,\n        photoUrl,\n        photoPublicId,\n        instaId,\n        email,\n        contact,\n      });\n      res.status(201).json({ member: doc });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to create member\" });\n    }\n  }\n\n  async delete(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    const member = await MemberModel.findById(id).lean();\n    if (!member) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n\n    try {\n      if ((member as any).photoPublicId) {\n        try {\n          await cloudinary.uploader.destroy((member as any).photoPublicId);\n        } catch {}\n      } else if (member.photoUrl && member.photoUrl.startsWith(\"/uploads/\")) {\n        const uploadsRoot = path.resolve(__dirname, \"../../public\");\n        const rel = member.photoUrl.replace(/^\\//, \"\");\n        const filePath = path.join(uploadsRoot, rel);\n        try {\n          if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n        } catch {}\n      }\n\n      await MemberModel.findByIdAndDelete(id);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to delete member\" });\n    }\n  }\n\n  async reorder(req: Request, res: Response): Promise<void> {\n    console.log(\"Reorder members request received\");\n    const { orderedIds } = (req.body || {}) as { orderedIds?: string[] };\n    if (!Array.isArray(orderedIds)) {\n      res.status(400).json({ error: \"orderedIds must be an array\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    try {\n      const promises = orderedIds.map(async (id, index) => {\n        console.log(`Updating member ${id} to position ${index}`);\n        const result = await MemberModel.updateOne({ _id: id }, { $set: { position: index } });\n        console.log(`Member ${id} update result:`, result);\n        return result;\n      });\n      await Promise.all(promises);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to reorder members\" });\n    }\n  }\n}\n","import { Router } from \"express\";\nimport { MemberController } from \"../controllers/MemberController\";\nimport { requireAdminKey } from \"../middleware/adminAuth\";\n\nconst router = Router();\nconst memberController = new MemberController();\n\nrouter.get(\"/\", (req, res) => memberController.getAll(req, res));\n\nrouter.post(\n  \"/admin\",\n  requireAdminKey,\n  memberController.getUploadMiddleware(),\n  (req, res) => memberController.create(req, res)\n);\n\nrouter.delete(\"/admin/:id\", requireAdminKey, (req, res) =>\n  memberController.delete(req, res)\n);\n\nrouter.post(\"/admin/reorder\", requireAdminKey, (req, res) =>\n  memberController.reorder(req, res)\n);\n\nexport default router;\n","import mongoose, { Schema } from \"mongoose\";\n\nconst CelebrationSchema = new Schema(\n  {\n    title: { type: String, required: true },\n    description: { type: String },\n    imageUrl: { type: String },\n    imagePublicId: { type: String },\n        position: { type: Number, default: 0 },\n    isEvent: { type: Boolean, default: false },\n  },\n  { timestamps: true }\n);\n\nexport const CelebrationModel = mongoose.model(\"Celebration\", CelebrationSchema);\n","import { Response, Request } from \"express\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { fileURLToPath } from \"url\";\nimport { v2 as cloudinary } from \"cloudinary\";\nimport { connectMongo } from \"../db\";\nimport { CelebrationModel } from \"../models/Celebration\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport class CelebrationController {\n  private uploadMiddleware = multer({\n    storage: multer.memoryStorage(),\n    limits: { fileSize: 20 * 1024 * 1024 },\n  });\n\n  private ensureUploadsDir(): string {\n    const uploadsDir = path.resolve(__dirname, \"../public/uploads\");\n    if (!fs.existsSync(uploadsDir))\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    return uploadsDir;\n  }\n\n  private configureCloudinary(): boolean {\n    const { CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET } =\n      process.env;\n    if (CLOUDINARY_CLOUD_NAME && CLOUDINARY_API_KEY && CLOUDINARY_API_SECRET) {\n      cloudinary.config({\n        cloud_name: CLOUDINARY_CLOUD_NAME,\n        api_key: CLOUDINARY_API_KEY,\n        api_secret: CLOUDINARY_API_SECRET,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  getUploadMiddleware() {\n    return this.uploadMiddleware.single(\"image\");\n  }\n\n  async getAll(req: Request, res: Response): Promise<void> {\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.json({ celebrations: [] });\n      return;\n    }\n    const celebrations = await CelebrationModel.find()\n      .sort({ isEvent: -1, position: 1 })\n      .lean();\n    res.json({ celebrations });\n  }\n\n  async getById(req: Request, res: Response): Promise<void> {\n    const { id } = req.params;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n    try {\n      const celebration = await CelebrationModel.findById(id).lean();\n      if (!celebration) {\n        res.status(404).json({ error: \"Celebration not found\" });\n        return;\n      }\n      res.json({ celebration });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to get celebration\" });\n    }\n  }\n\n  async create(req: Request, res: Response): Promise<void> {\n    const { title, description } = req.body as {\n      title: string;\n      description?: string;\n    };\n    const isEvent = req.body.isEvent === 'on';\n\n    if (!title) {\n      res.status(400).json({ error: \"title required\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let imageUrl: string | undefined;\n    let imagePublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n\n    try {\n      if (file) {\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          imageUrl = uploaded.secure_url;\n          imagePublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          imageUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const doc = await CelebrationModel.create({\n        title,\n        description,\n        imageUrl,\n        imagePublicId,\n        isEvent: isEvent || false,\n      });\n\n      res.status(201).json({ celebration: doc });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to create celebration\" });\n    }\n  }\n\n  async update(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { title, description } = req.body as {\n      title?: string;\n      description?: string;\n    };\n    const isEvent = req.body.isEvent === 'on';\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let imageUrl: string | undefined;\n    let imagePublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n\n    try {\n      const existing = await CelebrationModel.findById(id);\n      if (!existing) {\n        res.status(404).json({ error: \"Not found\" });\n        return;\n      }\n\n      if (file) {\n        // Delete old image if it exists\n        if (existing.imagePublicId) {\n          try {\n            await cloudinary.uploader.destroy(existing.imagePublicId);\n          } catch {}\n        } else if (existing.imageUrl?.startsWith(\"/uploads/\")) {\n          const uploadsRoot = path.resolve(__dirname, \"../public\");\n          const rel = existing.imageUrl.replace(/^\\//, \"\");\n          const filePath = path.join(uploadsRoot, rel);\n          try {\n            if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n          } catch {}\n        }\n\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          imageUrl = uploaded.secure_url;\n          imagePublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          imageUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const update: any = {};\n      if (title !== undefined) update.title = title;\n      if (description !== undefined) update.description = description;\n      if (imageUrl !== undefined) update.imageUrl = imageUrl;\n            if (imagePublicId !== undefined) update.imagePublicId = imagePublicId;\n      if (isEvent !== undefined) update.isEvent = isEvent;\n\n      const doc = await CelebrationModel.findByIdAndUpdate(id, update, {\n        new: true,\n      });\n\n      res.json({ celebration: doc });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to update celebration\" });\n    }\n  }\n\n  async delete(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    const celebration = await CelebrationModel.findById(id).lean();\n    if (!celebration) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n\n    try {\n      if ((celebration as any).imagePublicId) {\n        try {\n          await cloudinary.uploader.destroy((celebration as any).imagePublicId);\n        } catch {}\n      } else if (celebration.imageUrl?.startsWith(\"/uploads/\")) {\n        const uploadsRoot = path.resolve(__dirname, \"../public\");\n        const rel = celebration.imageUrl.replace(/^\\//, \"\");\n        const filePath = path.join(uploadsRoot, rel);\n        try {\n          if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n        } catch {}\n      }\n\n      await CelebrationModel.findByIdAndDelete(id);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to delete celebration\" });\n    }\n  }\n\n  async reorder(req: Request, res: Response): Promise<void> {\n    const { orderedIds } = req.body as { orderedIds?: string[] };\n    if (!Array.isArray(orderedIds)) {\n      res.status(400).json({ error: \"orderedIds must be an array\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    try {\n      const promises = orderedIds.map((id, index) =>\n        CelebrationModel.updateOne({ _id: id }, { $set: { position: index } })\n      );\n      await Promise.all(promises);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to reorder celebrations\" });\n    }\n  }\n}\n","import mongoose, { Schema } from \"mongoose\";\n\nconst ProductSchema = new Schema(\n  {\n    celebrationId: { type: Schema.Types.ObjectId, ref: \"Celebration\", required: true },\n    name: { type: String, required: true },\n    description: { type: String },\n    price: { type: Number, required: true },\n    imageUrl: { type: String },\n    imagePublicId: { type: String },\n    position: { type: Number, default: 0 },\n  },\n  { timestamps: true }\n);\n\nexport const ProductModel = mongoose.model(\"Product\", ProductSchema);\n","import { Response, Request } from \"express\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { fileURLToPath } from \"url\";\nimport { v2 as cloudinary } from \"cloudinary\";\nimport { connectMongo } from \"../db\";\nimport { ProductModel } from \"../models/Product\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport class ProductController {\n  private uploadMiddleware = multer({\n    storage: multer.memoryStorage(),\n    limits: { fileSize: 20 * 1024 * 1024 },\n  });\n\n  private ensureUploadsDir(): string {\n    const uploadsDir = path.resolve(__dirname, \"../public/uploads\");\n    if (!fs.existsSync(uploadsDir))\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    return uploadsDir;\n  }\n\n  private configureCloudinary(): boolean {\n    const { CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET } =\n      process.env;\n    if (CLOUDINARY_CLOUD_NAME && CLOUDINARY_API_KEY && CLOUDINARY_API_SECRET) {\n      cloudinary.config({\n        cloud_name: CLOUDINARY_CLOUD_NAME,\n        api_key: CLOUDINARY_API_KEY,\n        api_secret: CLOUDINARY_API_SECRET,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  getUploadMiddleware() {\n    return this.uploadMiddleware.single(\"image\");\n  }\n\n    async getByCategory(req: Request, res: Response): Promise<void> {\n    const { id } = req.params;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.json({ products: [] });\n      return;\n    }\n\n    const products = await ProductModel.find({ celebrationId: id })\n      .sort({ position: 1 })\n      .lean();\n    res.json({ products });\n  }\n\n  async create(req: Request, res: Response): Promise<void> {\n    const { name, description, price, celebrationId } = req.body as {\n      name: string;\n      description?: string;\n      price: number;\n      celebrationId: string;\n    };\n\n    if (!celebrationId || !name || price === undefined) {\n      res\n        .status(400)\n        .json({ error: \"celebrationId, name, and price required\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let imageUrl: string | undefined;\n    let imagePublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n\n    try {\n      if (file) {\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          imageUrl = uploaded.secure_url;\n          imagePublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          imageUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const doc = await ProductModel.create({\n        celebrationId,\n        name,\n        description,\n        price: Number(price),\n        imageUrl,\n        imagePublicId,\n      });\n\n      res.status(201).json({ product: doc });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to create product\" });\n    }\n  }\n\n  async update(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { name, description, price } = req.body as {\n      name?: string;\n      description?: string;\n      price?: number;\n    };\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    let imageUrl: string | undefined;\n    let imagePublicId: string | undefined;\n    const file = req.file;\n    const cloudOk = this.configureCloudinary();\n\n    try {\n      const existing = await ProductModel.findById(id);\n      if (!existing) {\n        res.status(404).json({ error: \"Not found\" });\n        return;\n      }\n\n      if (file) {\n        if (existing.imagePublicId) {\n          try {\n            await cloudinary.uploader.destroy(existing.imagePublicId);\n          } catch {}\n        } else if (existing.imageUrl?.startsWith(\"/uploads/\")) {\n          const uploadsRoot = path.resolve(__dirname, \"../public\");\n          const rel = existing.imageUrl.replace(/^\\//, \"\");\n          const filePath = path.join(uploadsRoot, rel);\n          try {\n            if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n          } catch {}\n        }\n\n        if (cloudOk) {\n          const uploaded = await new Promise<{\n            secure_url: string;\n            public_id: string;\n          }>((resolve, reject) => {\n            const stream = cloudinary.uploader.upload_stream(\n              { folder: process.env.CLOUDINARY_FOLDER || \"ngo-gallery\" },\n              (err, result) => {\n                if (err || !result) return reject(err);\n                resolve({\n                  secure_url: result.secure_url,\n                  public_id: result.public_id,\n                });\n              }\n            );\n            stream.end(file.buffer);\n          });\n          imageUrl = uploaded.secure_url;\n          imagePublicId = uploaded.public_id;\n        } else {\n          const uploadsDir = this.ensureUploadsDir();\n          const filename = `${Date.now()}-${file.originalname}`.replace(\n            /\\s+/g,\n            \"-\"\n          );\n          const filePath = path.join(uploadsDir, filename);\n          fs.writeFileSync(filePath, file.buffer);\n          imageUrl = `/uploads/${filename}`;\n        }\n      }\n\n      const update: any = {};\n      if (name !== undefined) update.name = name;\n      if (description !== undefined) update.description = description;\n      if (price !== undefined) update.price = price;\n      if (imageUrl !== undefined) update.imageUrl = imageUrl;\n      if (imagePublicId !== undefined) update.imagePublicId = imagePublicId;\n\n      const doc = await ProductModel.findByIdAndUpdate(id, update, {\n        new: true,\n      });\n\n      res.json({ product: doc });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to update product\" });\n    }\n  }\n\n  async delete(req: Request, res: Response): Promise<void> {\n    const id = req.params.id;\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    const product = await ProductModel.findById(id).lean();\n    if (!product) {\n      res.status(404).json({ error: \"Not found\" });\n      return;\n    }\n\n    try {\n      if ((product as any).imagePublicId) {\n        try {\n          await cloudinary.uploader.destroy((product as any).imagePublicId);\n        } catch {}\n      } else if (product.imageUrl?.startsWith(\"/uploads/\")) {\n        const uploadsRoot = path.resolve(__dirname, \"../public\");\n        const rel = product.imageUrl.replace(/^\\//, \"\");\n        const filePath = path.join(uploadsRoot, rel);\n        try {\n          if (fs.existsSync(filePath)) fs.unlinkSync(filePath);\n        } catch {}\n      }\n\n      await ProductModel.findByIdAndDelete(id);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to delete product\" });\n    }\n  }\n\n  async reorder(req: Request, res: Response): Promise<void> {\n    const { orderedIds } = req.body as { orderedIds?: string[] };\n    if (!Array.isArray(orderedIds)) {\n      res.status(400).json({ error: \"orderedIds must be an array\" });\n      return;\n    }\n\n    const { connected } = await connectMongo();\n    if (!connected) {\n      res.status(503).json({ error: \"Database not configured\" });\n      return;\n    }\n\n    try {\n      const promises = orderedIds.map((id, index) =>\n        ProductModel.updateOne({ _id: id }, { $set: { position: index } })\n      );\n      await Promise.all(promises);\n      res.json({ ok: true });\n    } catch (e) {\n      console.error(e);\n      res.status(500).json({ error: \"Failed to reorder products\" });\n    }\n  }\n}\n","import { Router } from \"express\";\nimport { CelebrationController } from \"../controllers/CelebrationController\";\nimport { ProductController } from \"../controllers/ProductController\";\nimport { requireAdminKey } from \"../middleware/adminAuth\";\n\nconst router = Router();\nconst celebrationController = new CelebrationController();\nconst productController = new ProductController();\n\n// Public routes\nrouter.get(\"/\", (req, res) => celebrationController.getAll(req, res));\nrouter.get(\"/:id\", (req, res) => celebrationController.getById(req, res));\nrouter.get(\"/:id/products\", (req, res) =>\n  productController.getByCategory(req, res)\n);\n\n// Admin routes - Celebrations\nrouter.post(\n  \"/admin\",\n  requireAdminKey,\n  celebrationController.getUploadMiddleware(),\n  (req, res) => celebrationController.create(req, res)\n);\n\nrouter.patch(\n  \"/admin/:id\",\n  requireAdminKey,\n  celebrationController.getUploadMiddleware(),\n  (req, res) => celebrationController.update(req, res)\n);\n\nrouter.delete(\"/admin/:id\", requireAdminKey, (req, res) =>\n  celebrationController.delete(req, res)\n);\n\nrouter.post(\"/admin/reorder\", requireAdminKey, (req, res) =>\n  celebrationController.reorder(req, res)\n);\n\n// Admin routes - Products\nrouter.post(\n  \"/products/admin\",\n  requireAdminKey,\n  productController.getUploadMiddleware(),\n  (req, res) => productController.create(req, res)\n);\n\nrouter.patch(\n  \"/products/admin/:id\",\n  requireAdminKey,\n  productController.getUploadMiddleware(),\n  (req, res) => productController.update(req, res)\n);\n\nrouter.delete(\"/products/admin/:id\", requireAdminKey, (req, res) =>\n  productController.delete(req, res)\n);\n\nrouter.post(\"/products/admin/reorder\", requireAdminKey, (req, res) =>\n  productController.reorder(req, res)\n);\n\nexport default router;\n","import mongoose, { Schema } from \"mongoose\";\n\nconst OrderItemSchema = new Schema(\n  {\n    productId: { type: Schema.Types.ObjectId, ref: \"Product\", required: true },\n    name: { type: String, required: true },\n    price: { type: Number, required: true },\n    quantity: { type: Number, required: true },\n  },\n  { _id: false }\n);\n\nconst OrderSchema = new Schema(\n  {\n    customerName: { type: String, required: true },\n    customerEmail: { type: String, required: true },\n    customerPhone: { type: String, required: true },\n    items: [OrderItemSchema],\n    totalAmount: { type: Number, required: true },\n    status: {\n      type: String,\n      enum: [\"pending\", \"confirmed\", \"shipped\", \"delivered\"],\n      default: \"pending\",\n    },\n  },\n  { timestamps: true }\n);\n\nexport const OrderModel = mongoose.model(\"Order\", OrderSchema);\n","import { Router, RequestHandler, json } from \"express\";\nimport { connectMongo } from \"../db\";\nimport { OrderModel } from \"../models/Order\";\n\nconst router = Router();\nrouter.use(json());\n\nrouter.post(\"/\", (async (req, res) => {\n  const { customerName, customerEmail, customerPhone, items } = req.body as {\n    customerName: string;\n    customerEmail: string;\n    customerPhone: string;\n    items: {\n      productId: string;\n      name: string;\n      price: number;\n      quantity: number;\n    }[];\n  };\n\n  if (!customerName || !customerEmail || !customerPhone || !items?.length) {\n    return res.status(400).json({\n      error: \"customerName, customerEmail, customerPhone, and items required\",\n    });\n  }\n\n  const { connected } = await connectMongo();\n  if (!connected) {\n    return res.status(503).json({ error: \"Database not configured\" });\n  }\n\n  try {\n    const totalAmount = items.reduce((sum, item) => sum + item.price * item.quantity, 0);\n\n    const order = await OrderModel.create({\n      customerName,\n      customerEmail,\n      customerPhone,\n      items,\n      totalAmount,\n      status: \"pending\",\n    });\n\n    const paymentUrl = `/payment/${order._id}`;\n\n    res.status(201).json({ order, paymentUrl });\n  } catch (e) {\n    console.error(e);\n    res.status(500).json({ error: \"Failed to create order\" });\n  }\n}) as RequestHandler);\n\nrouter.get(\"/:id\", (async (req, res) => {\n  const { id } = req.params;\n  const { connected } = await connectMongo();\n  if (!connected) {\n    return res.status(503).json({ error: \"Database not configured\" });\n  }\n\n  try {\n    const order = await OrderModel.findById(id).lean();\n    if (!order) {\n      return res.status(404).json({ error: \"Order not found\" });\n    }\n    res.json({ order });\n  } catch (e) {\n    console.error(e);\n    res.status(500).json({ error: \"Failed to fetch order\" });\n  }\n}) as RequestHandler);\n\nrouter.post(\"/:id/confirm\", (async (req, res) => {\n  const { id } = req.params;\n  const { connected } = await connectMongo();\n  if (!connected) {\n    return res.status(503).json({ error: \"Database not configured\" });\n  }\n\n  try {\n    const order = await OrderModel.findByIdAndUpdate(\n      id,\n      { status: \"paid\" },\n      { new: true }\n    ).lean();\n\n    if (!order) {\n      return res.status(404).json({ error: \"Order not found\" });\n    }\n\n    // Here you would typically trigger things like sending a confirmation email.\n    // For now, we just confirm the payment.\n\n    res.json({ order });\n  } catch (e) {\n    console.error(e);\n    res.status(500).json({ error: \"Failed to confirm order payment\" });\n  }\n}) as RequestHandler);\n\nexport default router;\n","import \"./preload\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\nimport multer from \"multer\";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nimport { connectMongo } from \"@/db\";\nimport { initAdminUser } from \"@/auth\";\n\n// Import route handlers\nimport { handleDemo } from \"@/routes/demo\";\nimport galleryRouter from \"@/routes/gallery\";\nimport donorsRouter from \"@/routes/donors\";\nimport authRouter from \"@/routes/auth\";\nimport membersRouter from \"@/routes/members\";\nimport celebrationsRouter from \"@/routes/celebrations\";\nimport ordersRouter from \"@/routes/orders\";\n\n\nasync function startServer() {\n  const app = express();\n\n  // Middleware MUST be configured before routes\n  const exactAllowedOrigins = new Set([\n    'http://localhost:3000',\n    'http://localhost:5173',\n    'http://localhost:8080',\n    'https://karuna-setu-foundation.vercel.app',\n  ]);\n\n  const vercelPreviewRegex = /^https?:\\/\\/.*\\.vercel\\.app$/i;\n\n  app.use(cors({\n    origin: function (origin, callback) {\n      // Allow same-origin/no-origin requests (like curl or server-to-server)\n      if (!origin) return callback(null, true);\n\n      if (\n        exactAllowedOrigins.has(origin) ||\n        vercelPreviewRegex.test(origin)\n      ) {\n        return callback(null, true);\n      }\n\n      return callback(new Error('Not allowed by CORS'));\n    },\n    credentials: true,\n    methods: ['GET', 'POST', 'PATCH', 'DELETE', 'OPTIONS'],\n    allowedHeaders: ['Content-Type', 'Authorization'],\n    optionsSuccessStatus: 204,\n  }));\n\n  // Parse JSON broadly to handle proxies that tweak content-type\n  app.use(express.json({ type: [\"application/json\", \"text/plain\", \"application/*+json\" ] }));\n  app.use(express.urlencoded({ extended: true }));\n\n  // Health check\n  app.get(\"/health\", (_req, res) => res.json({ ok: true }));\n\n  // Static files\n  const uploadsPath = path.resolve(__dirname, \"../public/uploads\");\n  app.use(\"/uploads\", express.static(uploadsPath));\n\n  // API Routes\n  app.get(\"/api/ping\", (_req, res) => {\n    res.json({ message: process.env.PING_MESSAGE || \"pong\" });\n  });\n  app.get(\"/api/demo\", handleDemo);\n  app.use(\"/api/admin\", authRouter);\n  app.use(\"/api/gallery\", galleryRouter);\n  app.use(\"/api/donors\", donorsRouter);\n  app.use(\"/api/members\", membersRouter);\n  app.use(\"/api/celebrations\", celebrationsRouter);\n  app.use(\"/api/orders\", ordersRouter);\n\n  // Await critical initializations before starting the server\n  await initAdminUser();\n  await connectMongo();\n\n  // Start server\n  const PORT = process.env.PORT || 8000;\n  app.listen(PORT, () => {\n    console.log(`✅ Server listening on port ${PORT}`);\n  });\n}\n\nstartServer().catch(err => {\n  console.error(\"❌ Failed to start server:\", err);\n  process.exit(1);\n});\n"],"names":["__dirname","hash","cloudinary","router","adminUser","authRouter","galleryRouter","donorsRouter","membersRouter","celebrationsRouter","ordersRouter"],"mappings":"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"}